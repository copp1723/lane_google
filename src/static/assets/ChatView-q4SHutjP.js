import{c as N,r as h,j as e,M as H,Z as q,T as L,D as O}from"./index-BneWKYxf.js";import{C as Z,B as F}from"./copy-C8R_cEpb.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=N("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=N("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=N("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=N("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=N("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=N("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=N("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);function Q(f){let i,s,c,p,x,v,j;return y(),{feed:S,reset:y};function y(){i=!0,s="",c=0,p=-1,x=void 0,v=void 0,j=""}function S(b){s=s?s+b:b,i&&W(s)&&(s=s.slice(P.length)),i=!1;const o=s.length;let a=0,r=!1;for(;a<o;){r&&(s[a]===`
`&&++a,r=!1);let u=-1,g=p,l;for(let d=c;u<0&&d<o;++d)l=s[d],l===":"&&g<0?g=d-a:l==="\r"?(r=!0,u=d-a):l===`
`&&(u=d-a);if(u<0){c=o-a,p=g;break}else c=0,p=-1;k(s,a,g,u),a+=u+1}a===o?s="":a>0&&(s=s.slice(a))}function k(b,o,a,r){if(r===0){j.length>0&&(f({type:"event",id:x,event:v||void 0,data:j.slice(0,-1)}),j="",x=void 0),v=void 0;return}const u=a<0,g=b.slice(o,o+(u?r:a));let l=0;u?l=r:b[o+a+1]===" "?l=a+2:l=a+1;const d=o+l,t=r-l,n=b.slice(d,d+t).toString();if(g==="data")j+=n?"".concat(n,`
`):`
`;else if(g==="event")v=n;else if(g==="id"&&!n.includes("\0"))x=n;else if(g==="retry"){const m=parseInt(n,10);Number.isNaN(m)||f({type:"reconnect-interval",value:m})}}}const P=[239,187,191];function W(f){return P.every((i,s)=>f.charCodeAt(s)===i)}class Y extends TransformStream{constructor(){let i;super({start(s){i=Q(c=>{c.type==="event"&&s.enqueue(c)})},transform(s){i.feed(s)}})}}function X({endpoint:f="/api/ai/stream",model:i="gpt-3.5-turbo",onToken:s,onComplete:c,onError:p,retryAttempts:x=3,retryDelay:v=1e3}={}){const[j,y]=h.useState(!1),[S,k]=h.useState(null),[b,o]=h.useState(""),a=h.useRef(null),r=h.useRef(0),u=h.useCallback(()=>{o(""),k(null),r.current=0},[]),g=h.useCallback(()=>{a.current&&(a.current.abort(),a.current=null),y(!1)},[]),l=h.useCallback(async(d,t={})=>{var m,A,R;k(null),o(""),y(!0),a.current=new AbortController;const n=t.signal||a.current.signal;try{const w=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:d,model:i,temperature:t.temperature,maxTokens:t.maxTokens,systemPrompt:t.systemPrompt,stream:!0}),signal:n});if(!w.ok){const C=await w.json().catch(()=>({}));throw new Error(C.message||`HTTP error! status: ${w.status}`)}if(!w.body)throw new Error("Response body is null");const M=w.body.pipeThrough(new TextDecoderStream).pipeThrough(new Y).getReader();let T="";for(;;){const{done:C,value:I}=await M.read();if(C||I.data==="[DONE]")break;try{const z=((R=(A=(m=JSON.parse(I.data||"{}").choices)==null?void 0:m[0])==null?void 0:A.delta)==null?void 0:R.content)||"";z&&(T+=z,o(D=>D+z),s==null||s(z))}catch(E){console.error("Error parsing SSE data:",E)}}y(!1),c==null||c(T),r.current=0}catch(w){const M=w;if(M.name==="AbortError"){y(!1);return}if(r.current<x){r.current++,console.log(`Retrying... Attempt ${r.current} of ${x}`),setTimeout(()=>{l(d,t)},v*r.current);return}k(M),y(!1),p==null||p(M),r.current=0}},[f,i,s,c,p,x,v]);return{stream:l,cancel:g,isStreaming:j,error:S,response:b,reset:u}}const te=({viewMode:f})=>{var d;const[i,s]=h.useState([{id:1,type:"assistant",content:"Hello! I'm your AI assistant for Google Ads management. I can help you with campaign optimization, keyword research, budget recommendations, and more. What would you like to work on today?",timestamp:new Date,suggestions:["Analyze my campaign performance","Suggest keyword optimizations","Review budget allocation","Create a new campaign"]}]),[c,p]=h.useState(""),[x,v]=h.useState(!1),j=h.useRef(null),y=h.useRef(null),{stream:S,isStreaming:k,response:b}=X({endpoint:"/api/ai/chat",onComplete:t=>{s(n=>{const m=[...n];return m[m.length-1]={...m[m.length-1],content:t,isStreaming:!1},m}),v(!1)}}),o=[{category:"Campaign Management",icon:q,prompts:["Create a search campaign for [product/service]","Optimize my underperforming campaigns","Pause campaigns with low ROI","Duplicate my best performing campaign"]},{category:"Keyword Research",icon:L,prompts:["Find new keywords for [topic]","Analyze keyword competition","Suggest negative keywords","Expand my keyword list"]},{category:"Budget & Bidding",icon:O,prompts:["Optimize my daily budget allocation","Suggest bid adjustments","Analyze cost per conversion","Set up automated bidding"]},{category:"Performance Analysis",icon:F,prompts:["Show me campaign performance trends","Compare this month vs last month","Identify top converting keywords","Analyze device performance"]}],a=()=>{var t;(t=j.current)==null||t.scrollIntoView({behavior:"smooth"})};h.useEffect(()=>{a()},[i]);const r=async()=>{if(c.trim()&&!k){const t={id:i.length+1,type:"user",content:c,timestamp:new Date},n={id:i.length+2,type:"assistant",content:"",timestamp:new Date,isStreaming:!0};s([...i,t,n]),p(""),v(!0),await S(c,{systemPrompt:"You are an expert Google Ads assistant. Provide helpful, actionable advice for managing and optimizing Google Ads campaigns."})}},u=t=>{var n;p(t),(n=y.current)==null||n.focus()},g=t=>{navigator.clipboard.writeText(t)},l=()=>{const t=[...i].reverse().find(n=>n.type==="user");t&&(p(t.content),r())};return e.jsxs("div",{className:"chat-view",children:[e.jsx("div",{className:"chat-header",children:e.jsxs("div",{className:"chat-header-content",children:[e.jsxs("div",{className:"chat-header-left",children:[e.jsx(H,{size:24,className:"chat-icon"}),e.jsxs("div",{children:[e.jsx("h2",{className:"chat-title",children:"AI Assistant"}),e.jsx("p",{className:"chat-subtitle",children:"Powered by advanced AI for Google Ads optimization"})]})]}),e.jsxs("div",{className:"chat-status",children:[e.jsx(K,{size:16}),e.jsx("span",{children:"AI Ready"})]})]})}),e.jsxs("div",{className:"chat-messages",children:[i.map(t=>e.jsxs("div",{className:`message ${t.type}`,children:[e.jsxs("div",{className:"message-content",children:[t.isStreaming?e.jsxs("div",{className:"message-text streaming",children:[b||"Thinking...",e.jsx("span",{className:"cursor-blink",children:"|"})]}):e.jsx("div",{className:"message-text",children:t.content}),t.suggestions&&!t.isStreaming&&e.jsx("div",{className:"message-suggestions",children:t.suggestions.map((n,m)=>e.jsx("button",{className:"suggestion-chip",onClick:()=>u(n),children:n},m))}),!t.isStreaming&&f!=="simple"&&e.jsxs("div",{className:"message-actions",children:[e.jsx("button",{className:"message-action",onClick:()=>g(t.content),title:"Copy",children:e.jsx(Z,{size:14})}),t.type==="assistant"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"message-action",title:"Helpful",children:e.jsx(J,{size:14})}),e.jsx("button",{className:"message-action",title:"Not helpful",children:e.jsx(U,{size:14})})]})]})]}),e.jsx("div",{className:"message-time",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id)),x&&((d=i[i.length-1])==null?void 0:d.isStreaming)&&e.jsxs("div",{className:"typing-indicator",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsx("div",{ref:j})]}),f!=="simple"&&i.length===1&&e.jsxs("div",{className:"task-prompts",children:[e.jsx("h3",{className:"prompts-title",children:"Quick Actions"}),e.jsx("div",{className:"prompts-grid",children:o.map(t=>e.jsxs("div",{className:"prompt-category",children:[e.jsxs("div",{className:"category-header",children:[e.jsx(t.icon,{size:16}),e.jsx("span",{children:t.category})]}),e.jsx("div",{className:"category-prompts",children:t.prompts.map((n,m)=>e.jsx("button",{className:"prompt-button",onClick:()=>u(n),children:n},m))})]},t.category))})]}),e.jsxs("div",{className:"chat-input-container",children:[f==="expert"&&e.jsxs("div",{className:"chat-tools",children:[e.jsx("button",{className:"tool-button",title:"Attach file",children:e.jsx(V,{size:16})}),e.jsx("button",{className:"tool-button",title:"Export conversation",children:e.jsx(B,{size:16})}),e.jsx("button",{className:"tool-button",title:"Regenerate last response",onClick:l,children:e.jsx(G,{size:16})})]}),e.jsxs("div",{className:"chat-input-wrapper",children:[e.jsx("textarea",{ref:y,value:c,onChange:t=>p(t.target.value),onKeyPress:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),r())},placeholder:"Ask about campaigns, keywords, optimization strategies...",className:"chat-input",rows:"1",disabled:k}),e.jsx("button",{onClick:r,disabled:!c.trim()||k,className:"send-button",children:e.jsx($,{size:20})})]}),e.jsx("div",{className:"input-hint",children:"Press Enter to send, Shift+Enter for new line"})]})]})};export{te as default};
