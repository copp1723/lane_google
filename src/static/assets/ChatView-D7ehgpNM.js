import{c as z,r as h,j as e,M as O,b as q,Z as F,T as H,D as B,B as Z,F as G,d as L}from"./index-BRZgLf3s.js";import{C as V}from"./copy-BvN3bDA2.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=z("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=z("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=z("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=z("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);function Q(f){let i,t,c,u,x,v,j;return y(),{feed:S,reset:y};function y(){i=!0,t="",c=0,u=-1,x=void 0,v=void 0,j=""}function S(b){t=t?t+b:b,i&&W(t)&&(t=t.slice(P.length)),i=!1;const o=t.length;let a=0,r=!1;for(;a<o;){r&&(t[a]===`
`&&++a,r=!1);let p=-1,g=u,l;for(let d=c;p<0&&d<o;++d)l=t[d],l===":"&&g<0?g=d-a:l==="\r"?(r=!0,p=d-a):l===`
`&&(p=d-a);if(p<0){c=o-a,u=g;break}else c=0,u=-1;N(t,a,g,p),a+=p+1}a===o?t="":a>0&&(t=t.slice(a))}function N(b,o,a,r){if(r===0){j.length>0&&(f({type:"event",id:x,event:v||void 0,data:j.slice(0,-1)}),j="",x=void 0),v=void 0;return}const p=a<0,g=b.slice(o,o+(p?r:a));let l=0;p?l=r:b[o+a+1]===" "?l=a+2:l=a+1;const d=o+l,s=r-l,n=b.slice(d,d+s).toString();if(g==="data")j+=n?"".concat(n,`
`):`
`;else if(g==="event")v=n;else if(g==="id"&&!n.includes("\0"))x=n;else if(g==="retry"){const m=parseInt(n,10);Number.isNaN(m)||f({type:"reconnect-interval",value:m})}}}const P=[239,187,191];function W(f){return P.every((i,t)=>f.charCodeAt(t)===i)}class Y extends TransformStream{constructor(){let i;super({start(t){i=Q(c=>{c.type==="event"&&t.enqueue(c)})},transform(t){i.feed(t)}})}}function X({endpoint:f="/api/ai/stream",model:i="gpt-3.5-turbo",onToken:t,onComplete:c,onError:u,retryAttempts:x=3,retryDelay:v=1e3}={}){const[j,y]=h.useState(!1),[S,N]=h.useState(null),[b,o]=h.useState(""),a=h.useRef(null),r=h.useRef(0),p=h.useCallback(()=>{o(""),N(null),r.current=0},[]),g=h.useCallback(()=>{a.current&&(a.current.abort(),a.current=null),y(!1)},[]),l=h.useCallback(async(d,s={})=>{var m,R,T;N(null),o(""),y(!0),a.current=new AbortController;const n=s.signal||a.current.signal;try{const w=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:d,model:i,temperature:s.temperature,maxTokens:s.maxTokens,systemPrompt:s.systemPrompt,stream:!0}),signal:n});if(!w.ok){const A=await w.json().catch(()=>({}));throw new Error(A.message||`HTTP error! status: ${w.status}`)}if(!w.body)throw new Error("Response body is null");const k=w.body.pipeThrough(new TextDecoderStream).pipeThrough(new Y).getReader();let I="";for(;;){const{done:A,value:M}=await k.read();if(A||M.data==="[DONE]")break;try{const C=((T=(R=(m=JSON.parse(M.data||"{}").choices)==null?void 0:m[0])==null?void 0:R.delta)==null?void 0:T.content)||"";C&&(I+=C,o(D=>D+C),t==null||t(C))}catch(E){console.error("Error parsing SSE data:",E)}}y(!1),c==null||c(I),r.current=0}catch(w){const k=w;if(k.name==="AbortError"){y(!1);return}if(r.current<x){r.current++,console.log(`Retrying... Attempt ${r.current} of ${x}`),setTimeout(()=>{l(d,s)},v*r.current);return}N(k),y(!1),u==null||u(k),r.current=0}},[f,i,t,c,u,x,v]);return{stream:l,cancel:g,isStreaming:j,error:S,response:b,reset:p}}const se=({viewMode:f})=>{var d;const[i,t]=h.useState([{id:1,type:"assistant",content:"Hello! I'm your AI assistant for Google Ads management. I can help you with campaign optimization, keyword research, budget recommendations, and more. What would you like to work on today?",timestamp:new Date,suggestions:["Analyze my campaign performance","Suggest keyword optimizations","Review budget allocation","Create a new campaign"]}]),[c,u]=h.useState(""),[x,v]=h.useState(!1),j=h.useRef(null),y=h.useRef(null),{stream:S,isStreaming:N,response:b}=X({endpoint:"/api/ai/chat",onComplete:s=>{t(n=>{const m=[...n];return m[m.length-1]={...m[m.length-1],content:s,isStreaming:!1},m}),v(!1)}}),o=[{category:"Campaign Management",icon:F,prompts:["Create a search campaign for [product/service]","Optimize my underperforming campaigns","Pause campaigns with low ROI","Duplicate my best performing campaign"]},{category:"Keyword Research",icon:H,prompts:["Find new keywords for [topic]","Analyze keyword competition","Suggest negative keywords","Expand my keyword list"]},{category:"Budget & Bidding",icon:B,prompts:["Optimize my daily budget allocation","Suggest bid adjustments","Analyze cost per conversion","Set up automated bidding"]},{category:"Performance Analysis",icon:Z,prompts:["Show me campaign performance trends","Compare this month vs last month","Identify top converting keywords","Analyze device performance"]}],a=()=>{var s;(s=j.current)==null||s.scrollIntoView({behavior:"smooth"})};h.useEffect(()=>{a()},[i]);const r=async()=>{if(c.trim()&&!N){const s={id:i.length+1,type:"user",content:c,timestamp:new Date},n={id:i.length+2,type:"assistant",content:"",timestamp:new Date,isStreaming:!0};t([...i,s,n]),u(""),v(!0),await S(c,{systemPrompt:"You are an expert Google Ads assistant. Provide helpful, actionable advice for managing and optimizing Google Ads campaigns."})}},p=s=>{var n;u(s),(n=y.current)==null||n.focus()},g=s=>{navigator.clipboard.writeText(s)},l=()=>{const s=[...i].reverse().find(n=>n.type==="user");s&&(u(s.content),r())};return e.jsxs("div",{className:"chat-view",children:[e.jsx("div",{className:"chat-header",children:e.jsxs("div",{className:"chat-header-content",children:[e.jsxs("div",{className:"chat-header-left",children:[e.jsx(O,{size:24,className:"chat-icon"}),e.jsxs("div",{children:[e.jsx("h2",{className:"chat-title",children:"AI Assistant"}),e.jsx("p",{className:"chat-subtitle",children:"Powered by advanced AI for Google Ads optimization"})]})]}),e.jsxs("div",{className:"chat-status",children:[e.jsx(q,{size:16}),e.jsx("span",{children:"AI Ready"})]})]})}),e.jsxs("div",{className:"chat-messages",children:[i.map(s=>e.jsxs("div",{className:`message ${s.type}`,children:[e.jsxs("div",{className:"message-content",children:[s.isStreaming?e.jsxs("div",{className:"message-text streaming",children:[b||"Thinking...",e.jsx("span",{className:"cursor-blink",children:"|"})]}):e.jsx("div",{className:"message-text",children:s.content}),s.suggestions&&!s.isStreaming&&e.jsx("div",{className:"message-suggestions",children:s.suggestions.map((n,m)=>e.jsx("button",{className:"suggestion-chip",onClick:()=>p(n),children:n},m))}),!s.isStreaming&&f!=="simple"&&e.jsxs("div",{className:"message-actions",children:[e.jsx("button",{className:"message-action",onClick:()=>g(s.content),title:"Copy",children:e.jsx(V,{size:14})}),s.type==="assistant"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"message-action",title:"Helpful",children:e.jsx(J,{size:14})}),e.jsx("button",{className:"message-action",title:"Not helpful",children:e.jsx(U,{size:14})})]})]})]}),e.jsx("div",{className:"message-time",children:s.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},s.id)),x&&((d=i[i.length-1])==null?void 0:d.isStreaming)&&e.jsxs("div",{className:"typing-indicator",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsx("div",{ref:j})]}),f!=="simple"&&i.length===1&&e.jsxs("div",{className:"task-prompts",children:[e.jsx("h3",{className:"prompts-title",children:"Quick Actions"}),e.jsx("div",{className:"prompts-grid",children:o.map(s=>e.jsxs("div",{className:"prompt-category",children:[e.jsxs("div",{className:"category-header",children:[e.jsx(s.icon,{size:16}),e.jsx("span",{children:s.category})]}),e.jsx("div",{className:"category-prompts",children:s.prompts.map((n,m)=>e.jsx("button",{className:"prompt-button",onClick:()=>p(n),children:n},m))})]},s.category))})]}),e.jsxs("div",{className:"chat-input-container",children:[f==="expert"&&e.jsxs("div",{className:"chat-tools",children:[e.jsx("button",{className:"tool-button",title:"Attach file",children:e.jsx(G,{size:16})}),e.jsx("button",{className:"tool-button",title:"Export conversation",children:e.jsx(L,{size:16})}),e.jsx("button",{className:"tool-button",title:"Regenerate last response",onClick:l,children:e.jsx($,{size:16})})]}),e.jsxs("div",{className:"chat-input-wrapper",children:[e.jsx("textarea",{ref:y,value:c,onChange:s=>u(s.target.value),onKeyPress:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),r())},placeholder:"Ask about campaigns, keywords, optimization strategies...",className:"chat-input",rows:"1",disabled:N}),e.jsx("button",{onClick:r,disabled:!c.trim()||N,className:"send-button",children:e.jsx(K,{size:20})})]}),e.jsx("div",{className:"input-hint",children:"Press Enter to send, Shift+Enter for new line"})]})]})};export{se as default};
